# 변동성 돌파 전략 백테스트 프로젝트

래리 윌리엄스의 변동성 돌파 전략을 한국 주식 시장에 적용한 체계적 백테스트 및 자동매매 시스템 개발 프로젝트

## 📋 목차
- [프로젝트 개요](#프로젝트-개요)
- [전략 설명](#전략-설명)
- [개발 환경](#개발-환경)
- [백테스트 결과](#백테스트-결과)
- [파일 구조](#파일-구조)
- [실행 방법](#실행-방법)
- [다음 단계](#다음-단계)

---

## 🎯 프로젝트 개요

**목표:** 변동성 돌파 전략으로 3-5년간 5-10억원 수익 달성

**기간:** 2025년 12월 시작

**핵심 전략:**
- 래리 윌리엄스 변동성 돌파 전략
- 20일 이동평균선 필터 추가
- 종목별 최적 K값 적용
- 효율성 기반 포트폴리오 구성

---

## 📊 전략 설명

### 기본 변동성 돌파 전략
```
매수 조건:
- 당일 고가 >= 당일 시가 + (전일 Range × K)
- AND 종가 > 20일 이동평균선

매도 조건:
- 다음날 시가에 전량 매도

K값: 0.3 ~ 0.7 (종목별 최적화)
```

### 개선 사항

1. **20일선 필터 추가**
   - 기본 전략 CAGR: 13.87% (삼성전자)
   - 20일선 추가 후: 27.55% (약 2배)
   - 승률: 52% → 60%
   - MDD: -21% → -9%

2. **실전 비용 반영**
   - 수수료: 0.03%
   - 증권거래세: 0.23%
   - 슬리피지: 0.1%
   - **총 비용: 0.36%**

3. **K값 최적화**
   - 종목별 효율성(CAGR/거래횟수) 기반 최적 K값 선정
   - K=0.3~0.7 범위에서 테스트

---

## 💻 개발 환경

### 필수 프로그램
- Python 3.11.x
- VS Code

### 라이브러리
```bash
pip install finance-datareader pandas numpy openpyxl
```

### 데이터 소스
- FinanceDataReader (한국 주식 데이터)
- 기간: 2005-2025 (약 20년)

---

## 📈 백테스트 결과

### 1단계: 개별 종목 테스트

**네이버 (035420)**
- 기간: 2013-2025 (12년)
- CAGR: 30.84%
- MDD: -16.51%
- 승률: 54.89%
- 거래: 716회
- 1천만원 → 2억 6,729만원

**삼성전자 (005930)**
- 기간: 2013-2025 (12년)
- CAGR: 27.55%
- MDD: -9.66%
- 승률: 60.25%
- 거래: 727회
- 1천만원 → 1억 9,584만원

### 2단계: 시총 TOP 30 변동성 분석

**변동성 TOP 10 (1/2/3년 평균)**
1. 고려아연: 71.76%
2. 알테오젠: 65.42%
3. 한화오션: 61.07%
4. HD현대일렉트릭: 60.50%
5. 한화에어로스페이스: 60.20%
6. SK스퀘어: 58.77%
7. 두산에너빌리티: 56.25%
8. SK하이닉스: 50.63%
9. HD현대중공업: 50.50%
10. 삼성SDI: 47.43%

### 3단계: K값 최적화 (실전 비용 반영)

**K값별 평균 성과**
- K=0.3: CAGR 42.2%, 거래 823회
- K=0.4: CAGR 35.9%, 거래 706회 ⭐
- K=0.5: CAGR 30.3%, 거래 605회
- K=0.6: CAGR 27.6%, 거래 515회
- K=0.7: CAGR 23.2%, 거래 438회

### 4단계: 효율성 기반 종목 선정

**효율 = CAGR ÷ 거래횟수 × 100**

**효율 TOP 4**
1. HD현대중공업 (329180): 효율 14.76, K=0.3
2. 알테오젠 (196170): 효율 12.02, K=0.6
3. 두산에너빌리티 (034020): 효율 7.93, K=0.3
4. HD현대일렉트릭 (267260): 효율 7.39, K=0.5

### 5단계: 포트폴리오 백테스트

**4종목 균등 분산 (각 25%)**
- 기간: 2005-2025 (20년)
- CAGR: **46.2%** 🔥
- MDD: -8.5%
- 총 수익률: 9,125%
- 1천만원 → **9억 2,250만원**

### 6단계: 분기 리밸런싱 테스트

**3개월마다 효율 TOP 4 재선정**
- 기간: 2010-2024 (10년)
- CAGR: 19.8%
- 1천만원 → 1억 5,056만원

**결론:** 고정 포트폴리오가 리밸런싱보다 우수

---

## 📁 파일 구조
```
Vol_Breakout_test/
├── README.md                          # 프로젝트 설명
├── vol_breakout_test.py               # 메인 백테스트
├── k_optimization_full.py             # K값 최적화
├── portfolio_backtest.py              # 포트폴리오 백테스트
├── quarterly_rebalancing.py           # 분기 리밸런싱
├── consistency_check.py               # 종목별 일관성 분석
├── analyze.py                         # 결과 분석
├── volatility_ranking.csv             # 변동성 순위
├── backtest_results.csv               # 백테스트 결과
├── k_optimization_results.csv         # K값 최적화 결과
└── rebalancing_history.csv            # 리밸런싱 히스토리
```

---

## 🚀 실행 방법

### 1. 환경 설정
```bash
# Python 3.11 설치 확인
python --version

# 라이브러리 설치
python -m pip install finance-datareader pandas numpy openpyxl
```

### 2. 백테스트 실행
```bash
# 메인 백테스트 (시총 TOP 30 분석)
py vol_breakout_test.py

# K값 최적화
py k_optimization_full.py

# 포트폴리오 백테스트
py portfolio_backtest.py

# 분기 리밸런싱
py quarterly_rebalancing.py
```

### 3. 결과 확인
- CSV 파일들을 엑셀로 열어서 확인
- 또는 `analyze.py` 실행

---

## 📊 핵심 발견

### ✅ 성공 요인
1. **20일선 필터의 위력**
   - 거래 횟수 42% 감소
   - CAGR 2배 증가
   - MDD 절반 감소
   - 승률 8%p 증가

2. **포트폴리오 분산 효과**
   - 개별 종목보다 안정적
   - MDD -8.5% (매우 낮음)
   - CAGR 46.2% (매우 높음)

3. **효율성 기반 선정**
   - 거래 1회당 수익 극대화
   - 비용 대비 수익 최적화

### ⚠️ 주의사항
1. **백테스트 한계**
   - 과거 성과 ≠ 미래 보장
   - 실전에서 슬리피지 더 클 수 있음
   - 심리적 요인 미반영

2. **테마주 위험**
   - 한화에어로스페이스: 1년 112%, 전체 -101%
   - 일시적 테마 vs 구조적 변동성 구분 필요

3. **거래 비용**
   - 연 600-800회 거래 시 비용 12-14% 잠식
   - K값 낮추면 수익 높지만 비용도 증가

---

## 🎯 다음 단계

### Phase 1: 자동매매 시스템 개발 (진행 중)
- [ ] 키움증권 OpenAPI 연동
- [ ] 로그인 자동화
- [ ] 실시간 시세 수신
- [ ] 매수/매도 주문 실행
- [ ] 전략 로직 연결

### Phase 2: 모의투자 (1-2개월)
- [ ] 가상 계좌로 실전 테스트
- [ ] 백테스트 vs 실전 차이 분석
- [ ] 슬리피지 실측
- [ ] 심리적 부담 체험

### Phase 3: 실전 투자
- [ ] 소액(100만원) 시작
- [ ] 1-2개월 검증 후 확대
- [ ] 목표: 3-5년간 5-10억원

---

## 📝 프로젝트 로그

**2025-12-02**
- 프로젝트 시작
- Python 환경 설정
- 네이버/삼성전자 백테스트 완료
- 20일선 필터 효과 확인

**2025-12-02 (오후)**
- 시총 TOP 30 변동성 분석
- K값 최적화 (0.3-0.7)
- 효율성 기반 종목 선정
- 포트폴리오 백테스트 완료
- CAGR 46.2% 달성 확인

**2025-12-02 (저녁)**
- 분기 리밸런싱 테스트
- 키움증권 OpenAPI 신청
- GitHub 문서화

---

## 💡 참고 자료

### 전략 출처
- 래리 윌리엄스, "Long-Term Secrets to Short-Term Trading"
- 강환국, "가상화폐 투자 마법 공식" (절판)

### 학습 내용
- 변동성 돌파 전략 원리
- 추세 필터의 중요성
- K값 최적화 방법론
- 포트폴리오 구성 원칙
- 실전 비용 산정

---

## ⚖️ 면책 조항

- 이 프로젝트는 교육 및 연구 목적입니다
- 투자 권유가 아니며, 투자 결과에 대한 책임은 투자자 본인에게 있습니다
- 과거 백테스트 결과가 미래 수익을 보장하지 않습니다
- 실전 투자 전 충분한 검증과 리스크 관리가 필요합니다

---

## 📧 Contact

프로젝트 관련 문의: [GitHub Issues]

---

**Last Updated:** 2025-12-02